### 找不到可用代理？给你 4 条可行出路

1.  **问运维 / 网络管理员**  
    公司或学校通常有统一对外的 **HTTP 代理**（常见端口 8080、3128、7890），直接要地址+端口即可；需要账号就一并问。
1.  **自己临时搭一个**  
    有能出国的云主机的话，2 分钟就能搭一个 **tinyproxy/squid** 正向代理，监听 `0.0.0.0:8080`，再把 `http_proxy=http://云主机IP:8080` 写到本地即可。
1.  **用本地 SOCKS5 代理转一下**  
    如果已经开了 **Clash/V2Ray/Shadowsocks**（默认本地 1080/7890 端口），可以借助 `proxychains-ng` 或 `graftcp` 把命令行流量转过去；  
    或者给 Docker 写一个 **systemd drop-in** 文件，把 `HTTP_PROXY=socks5://127.0.0.1:1080` 写进去也行。
    
    你遇到的问题是 **“WSL 里的流量根本没走到 Windows 端的 Clash Verge”**，所以 `curl` 一直挂起直到你按 Ctrl-Z。  
WSL 的网络栈和 Windows 宿主机是隔离的，**allow-lan=true 只是让“别的机器”能通过你的 Windows IP 上网**，并不能让 WSL 自动把流量甩给 Clash。要把 WSL 的流量接进来，有三条常见路线，按“改动从小到大”给你：

--------------------------------
1. 最快临时法：手动把 WSL 的代理变量指到 Clash  
在 WSL 终端里执行（假设 Clash 开的 HTTP 端口是 7890，IP 用 Windows 在 WSL 侧的默认网关）：

```bash
# 找到 Windows 侧 IP（WSL 默认网关）
export HOST_IP=$(ip route | grep default | awk '{print $3}')
export http_proxy="http://$HOST_IP:7897"
export https_proxy="http://$HOST_IP:7897"
# 再测
curl -I https://www.google.com
```

能通就说明节点没问题；把上面三行写进 `~/.bashrc` 或 `~/.zshrc` 就能永久生效。  
**缺点**：只能代理“认得这些变量”的命令行程序，Docker、apt、snap 等不一定吃。

--------------------------------
2. 一劳永逸法：让 WSL 所有流量走 Windows 的 Clash TUN  
原理：Clash 在 Windows 上开启 TUN 模式后会多出一张虚拟网卡，把整台电脑（含 WSL）的流量直接吞进来，无需手动设代理。

步骤  
① Clash Verge → 设置 → 服务模式（Service Mode）点“安装”，安装完重启 Clash；  
② 打开“TUN 模式”开关，选 Stack 为 `gvisor` 或 `mixed`；  
③ 回到 WSL，什么变量都不用设，直接  
   `curl -I www.google.com`  
   应该返回 200。  

**注意**  
- 必须开 Service Mode，否则 Clash 无法创建虚拟网卡；  
- WSL2 内核 ≥ 5.15 一般没问题，WSL1 不行。
- 要注意端口号
- 要打开局域网连接按钮
--------------------------------
3. 折中法：WSL 里再跑一个 clash-core，用 Windows 当网关  
如果你不想开 TUN，也可以在 WSL 里放一份 clash-core，config 里把 Windows 的 7890 当上游（`&external-controller` 保持 127.0.0.1:9090 指向 Windows 侧），再把 WSL 的 `http_proxy` 指向本地的 7890。这样 Windows 与 WSL 共用同一份规则，但维护两份二进制，比较折腾。

--------------------------------
快速自检清单  
- `ip route | grep default` 能看到 Windows 的 IP（一般是 172.x.x.1）。  
- `telnet $HOST_IP 7897` 能连上，说明 WSL→Windows 端口可达；如果连不上，关 Windows 防火墙或把 clash-core.exe 加入白名单。  
- 只要 TUN 开启且状态为 Up，WSL 里 `ip route` 会把 default 指向这张虚拟网卡，无需再配任何变量。

**结论**  
你现在只是缺了“WSL 把流量递给 Windows 侧 Clash”这一步；按路线 1 可立即验证，路线 2 可彻底根治。

